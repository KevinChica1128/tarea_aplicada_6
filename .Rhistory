cadata <- read.csv("~/GitHub/tarea_aplicada_6/cadata.txt", sep="")
View(cadata)
cadata<- cadata[-c(1:15528,16029:20640),]
modelo<- lm(cadata$Valor_mediano_de_la_casa ~ cadata$Ingreso_mediano+
cadata$Edad_mediana_de_la_vivienda+cadata$Total_de_habitaciones+
cadata$Total_de_dormitorios+cadata$Poblacion+cadata$Hogares)
summary(modelo)
step(modelo,direction = "backward")
library(leaps)
best.subset <- regsubsets(modelo)
best.subset <- regsubsets(summary(modelo))
modelostep<-step(modelo,direction = "backward") #Por AIC
library(leaps)
kmodeloback <- regsubsets.formula(modelo)
kmodeloback <- regsubsets(cadata$Valor_mediano_de_la_casa ~ cadata$Ingreso_mediano+
cadata$Edad_mediana_de_la_vivienda+cadata$Total_de_habitaciones+
cadata$Total_de_dormitorios+cadata$Poblacion+cadata$Hogares)
kmodeloback <- regsubsets(cadata$Valor_mediano_de_la_casa ~ cadata$Ingreso_mediano+
cadata$Edad_mediana_de_la_vivienda+cadata$Total_de_habitaciones+
cadata$Total_de_dormitorios+cadata$Poblacion+cadata$Hogares,data = cadata)
modeloback <- regsubsets(cadata$Valor_mediano_de_la_casa ~ cadata$Ingreso_mediano+
cadata$Edad_mediana_de_la_vivienda+cadata$Total_de_habitaciones+
cadata$Total_de_dormitorios+cadata$Poblacion+cadata$Hogares,data = cadata)
modeloback
summary(modeloback)
modeloback.summary$outmat
S<-summary(modeloback)
S
S$outmat
S$outmat
S$adjr2
which.max(S$adjr2)
modeloCP<-S$cp
modeloCP<-which.max(S$cp)
modeloCP
modeloCP<-which.min(S$cp)
modeloCP
modeloBIC<-which.min(S$bic)
modeloBIC
summary(modelostep)
coef(best.subset,2)
coef(modeloback,2)
S<-summary(modeloback)
S
coef(modeloback,5)
coef(modeloback,5) #Coeficientes del mejor modelo
summary(modelostep)
summary(modelostep)$r.squared
S$outmat
S$adjr2
summary(modelostep)$r.squared
summary(modelostep)$adjustr.squared
summary(modelostep)$adrj2
summary(modelostep)$r.squared
summary(modelostep)
summary(modelostep)$r.squared
summary(modelostep)$Adjuste.r.squared
#Con el cÃ³digo 2
#Matriz X:
X<-matrix(c(cadata$Ingreso_mediano,cadata$Edad_mediana_de_la_vivienda,cadata$Total_de_habitaciones,
cadata$Total_de_dormitorios,cadata$Poblacion,cadata$Hogares),nrow = 500,ncol = 6)
X
Y<-cadata$Valor_mediano_de_la_casa
leaps(X,Y,method = "adjr2")
modelo3<-leaps(X,Y,method = "adjr2")
summary(modelo3)
modelo3<-leaps(X,Y,method = "adjr2")
modelo3
which.max(modelo3$adjr2)
coef(modeloback,5) #Coeficientes del mejor modelo
summary(modelostep)$r.squared
#StepAIC
modelostep<-step(modelo,direction = "backward") #Por AIC
modelostep
step(modelo,direction = "backward")$r.squared
#StepAIC
modelostep<-step(modelo,direction = "backward") #Por AIC
summary(modelostep)$r.squared
#StepAIC
modelostepB<-step(modelo,direction = "backward") #Por AIC
modelostepF<-step(modelo,direction = "forward")
summary(modelostepF)
modelostepBo<-step(modelo,direction = "both")
summary(modelostepBo)
modeloback <- regsubsets(cadata$Valor_mediano_de_la_casa ~ cadata$Ingreso_mediano+
cadata$Edad_mediana_de_la_vivienda+cadata$Total_de_habitaciones+
cadata$Total_de_dormitorios+cadata$Poblacion+cadata$Hogares,data = cadata)
S<-summary(modeloback)
S$outmat
modeloback <- regsubsets(cadata$Valor_mediano_de_la_casa ~ cadata$Ingreso_mediano+
cadata$Edad_mediana_de_la_vivienda+cadata$Total_de_habitaciones+
cadata$Total_de_dormitorios+cadata$Poblacion+cadata$Hogares,
data = cadata,method = "Backward")
modeloback <- regsubsets(cadata$Valor_mediano_de_la_casa ~ cadata$Ingreso_mediano+
cadata$Edad_mediana_de_la_vivienda+cadata$Total_de_habitaciones+
cadata$Total_de_dormitorios+cadata$Poblacion+cadata$Hogares,
data = cadata, method = "backward")
S<-summary(modeloback)
S
S$outmat
modeloR2<-which.max(S$adjr2) #El mejor modelo con el R2 ajus es el de 5 variables.
modeloR2
modeloCP<-which.min(S$cp) #Al igual que con el CP
modeloBIC<-which.min(S$bic) #Y con el BIC
coef(modeloback,5) #Coeficientes del mejor modelo
modelostepBo<-step(modelo,direction = "both")
summary(modelostepBo)
#Con el cÃ³digo 2
#Matriz X:
X<-matrix(c(cadata$Ingreso_mediano,cadata$Edad_mediana_de_la_vivienda,cadata$Total_de_habitaciones,
cadata$Total_de_dormitorios,cadata$Poblacion,cadata$Hogares),nrow = 500,ncol = 6)
Y<-cadata$Valor_mediano_de_la_casa
modelo3<-leaps(X,Y,method = "adjr2")
modelo3
which.max(modelo3$adjr2)
coef(modeloback,5) #Coeficientes del mejor modelo
#StepAIC
modelostepB<-step(modelo,direction = "backward") #Por AIC
summary(modelostepB) #AIC Backward
modelo<- lm(cadata$Valor_mediano_de_la_casa ~ cadata$Ingreso_mediano+
cadata$Edad_mediana_de_la_vivienda+cadata$Total_de_habitaciones+
cadata$Total_de_dormitorios+cadata$Poblacion+cadata$Hogares)
summary(modelo)
